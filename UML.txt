@startuml

title zKill_scraper - Class Diagram

class Thread
class ABC

class Controller

class Killmail {
    logger: Logger
    id: Int
    time: DateTime
    total_value: Float
    solar_system_name: String
    attacker_is_npc: Bool
    attacker_is_awox: Bool
    attacker_is_solo: Bool
    attacker_amount: Int
    attacker_char_name: String
    attacker_corp_name: String
    attacker_alliance_name: String
    attacker_ship_names: String
    victim_damage_taken: Int
    victim_char_name: String
    victim_corp_name: String
    victim_alliance_name: String
    victim_ship_name: String


  __init__(unprocessed_killmail)
}

class Logger
class PerformanceAnalysis

class InfluxPusher{
    logger: Logger
    __init__():void
    assembleJsonBody(killmail Killmail): json_body List
    writeToDatabase(killmail Killmail): void

}

class RedisQ{
    logger: Logger
    __init__()
    makeCall(): unprocessed_killmail Dict
}

class EsiCall{
    logger: Logger
    __init__()
    makeCall(): names Dict

}

class NameFetcher << abstract >>{
    logger: Logger
    unprocessed_killmail: Dict
    __init__(unprocessed_killmail)
    makeCall(): EsiCall.makeCall()
    getNames():
    generateIdList():
    fetchNameWithId(): names String
    extractNamesFromDict(names_dict): names
}

class SolarNameFetcherLocal{
    generateIdList(): solar_system_id Int
    extractNamesFromDict(names_dict Dict): names_dict Dict
    fetchNameWithId(): solar_system_name String
    getNames(): solar_system_name Dict
}

class VictimNameFetcher{
    getNames(): victim_names Dict
    generateIdList(): victim_ids List
}

class AttackerNameFetcher{
    getNames(): attacker_names Dict
    generateIdList(): attacker_ids List
}

class ShipNameFetcher{
    fetchNameWithId(): ship_name_str String
}

class AttackerShipNameFetcher{
    getNames(): attacker_ship Dict
    generateIdList(): attacker_ship_list List
}

class VictimShipNameFetcher{
    getNames(): victim_ship_dict Dict
    generateIdList(): victim_ship_list List
}

ABC <|-left- NameFetcher
Thread <|-left- NameFetcher

NameFetcher <|-down- SolarNameFetcherLocal
NameFetcher <|-down- AttackerNameFetcher
NameFetcher <|-down- VictimNameFetcher
NameFetcher <|-down- ShipNameFetcher
ShipNameFetcher <|-down- AttackerShipNameFetcher
ShipNameFetcher <|-down- VictimShipNameFetcher

NameFetcher -left- "1" EsiCall

Controller *-up- "1" PerformanceAnalysis
Controller *-up- "1" Logger
Controller *-down- "*" RedisQ
Controller *-right- "*" Killmail
Controller *-left- "1" InfluxPusher
Killmail *-down- "*" NameFetcher

@enduml